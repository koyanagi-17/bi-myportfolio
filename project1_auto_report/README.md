# 広告運用レポートの自動集計・分析

## 概要
BigQueryから取得した広告運用のデータを自動で集計し、**定型レポート作成を効率化するGoogle スプレッドシート × Google Apps Script（GAS） の自動化ツール**です。

---

## 目的・背景
広告運用チームで毎月発生していた「成果データの集計」「月別レポートの更新作業」に多くの時間と手間がかかっていたため、  
**ヒューマンエラーの防止・属人化の解消・作業負担の軽減**を目的に、Google スプレッドシート ＋ GAS で作業を自動化しました。

BIツールではなくスプレッドシートを選定したのは、**非エンジニアメンバーでも扱いやすく、柔軟な加工・社内共有が可能なためです。**

---

## 特徴
- `QUERY`＋`IMPORTRANGE`＋`ARRAYFORMULA` を活用し、スプレッドシート上で高速かつ柔軟な集計処理を実現
- 特定の商材データのみを抽出・整形し、成果指標（CPA・CVR等）を自動算出
- 手作業での入力・コピペミスを防止し、**正確性と再現性が高く、品質が安定したレポート作成**が可能に
- **ChatGPTを活用してGASコードを作成・改善**
    - 作業内容を自然言語で整理し、AIによるコード生成をもとに実装
    - 手順明確化 → 実装 → テスト → 本番導入までを自走
- GASの時間トリガー（スケジューラー）により、更新作業を **完全自動化**
- 運用フローの属人化を解消し、**非エンジニアメンバーでも扱える共通の業務基盤**に

---

## Google スプレッドシート構成

| シート名 | 内容 |
|--------|------|
| `00_INDEX` | 商材別レポートや月別集計へのリンクをまとめたインデックスシート |
| `01_DATA_FILTERED` | BigQueryから取得した全データの集約シートから、特定の商材データを自動抽出・集計（`IMPORTRANGE`・`QUERY`使用） |
| `02_MONTHLY_SUMMARY` | 各商材レポートシートから成果指標（CPA・CVRなど）を月別に集計。全体進捗を俯瞰できるダッシュボード的役割 |
| `2024-01_A_Report` | 商材Aの広告レポート（日次・週次の成果指標）※広告キャンペーン別の集計 |

※ 商材レポートタブは `YYYY-MM_商材名_Report` 形式で命名し、運用性と視認性を向上

---

## 使用技術
- Google スプレッドシート（QUERY, XLOOKUP, ARRAYFORMULA 等）
- Google Apps Script  
ChatGPT（AI）によるコード補助を活用し、非エンジニアでも高度な処理を実現
- BigQuery（Google スプレッドシートのデータコネクタ経由）

---

## 利用対象者
- 広告運用担当者
- データ集計を行うマーケティング担当者
- レポート作成を行う業務アシスタント担当者

---

## 活用による効果
- 毎月発生する更新作業を**ほぼ完全に自動化**し、**作業工数を月10時間以上削減**
- 作業プロセスをドキュメント化＋スクリプト化したことで**属人化を解消**
- ミスやヌケモレを防ぎつつ、誰でも同じ成果物を再現可能な環境を実現

---

## ファイル構成（GAS）

| ファイル名 | 内容 |
|------------|------|
| `onOpen.gs` | カスタムメニューの追加 |
| `trigger.gs` | 月末の定期自動実行を設定 |
| `multiprocessor.gs` | 複数処理をまとめて実行 |
| `copyTabs.gs` | 各商材レポートシートの複製処理 |
| `clearCells.gs` | 複製後に手入力エリアをクリア |
| `copyFunctionCells.gs` | 月別集計タブの関数セルを更新 |
| `getSheetName.gs` | INDEXタブに表示するシート名を取得 |
| `MoveActiveSheet.gs` | シートの並び順を調整 |
| `setFileNameToCell.gs` | Google スプレッドシートのファイル名をセルに表示 |

---

## 実際の Google スプレッドシート  

- [広告レポート自動集計・分析（閲覧用）](https://docs.google.com/spreadsheets/d/1d1GF3-Cb-T35ocooElEliWLSJrUc1L1500kz25qQSRg/edit?gid=644686713#gid=644686713)

