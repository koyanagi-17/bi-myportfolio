# SmartNews広告 入稿CSV自動生成ツール（GAS + スプレッドシート）

## 目的・背景
一度に大量のクリエイティブをSmartNews広告へ入稿するには、**配信クリエイティブごとに専用のCSVファイルを作成し、バナー画像とともにzipファイル化して提出**する必要がありました。
その作業には以下のような課題がありました：
- 作業時間が非常にかかる（組み合わせが多い場合、数時間〜半日以上）
- 作成したバナー画像は各個人のPCに保管されており、管理が煩雑
- ミスを防ぐためのチェックも手作業になりやすく、非効率

このツールは、**入稿作業の自動化・効率化・ミス防止**を目的として、Google スプレッドシートとGoogle Apps Script（GAS）を用いて開発されました。

---

## 概要
このツールは、SmartNews広告の一括入稿に必要なCSVファイルと、バナー画像を含んだzipファイルを、スプレッドシートの操作だけで自動生成できる仕組みです。
入力するデータ：
広告主名

広告グループID

バナー画像のファイル名（Googleドライブ上に格納）

記事LPのURL

広告文（タイトル・説明文など）

スプレッドシート関数が自動で広告パターンを展開し、Google Apps Scriptが媒体指定のCSV形式に整形して出力します。
また、指定されたバナーファイルをGoogleドライブから取得し、zipファイルとして保存・ダウンロードできるようにしています。

---

## 特徴
- `QUERY`＋`IMPORTRANGE`＋`ARRAYFORMULA` を活用し、スプレッドシート上で高速かつ柔軟な集計処理を実現
- 特定の商材データのみを抽出・整形し、成果指標（CPA・CVR等）を自動算出
- 手作業での入力・コピペミスを防止し、**正確性と再現性の高いレポート作成**が可能に
- **ChatGPTを活用してGASコードを作成・改善**
  - 作業内容を自然言語で整理し、AIによるコード生成をもとに実装
  - 手順明確化 → 実装 → テスト → 本番導入までを自走
- **GASの時間トリガーにより、更新作業を全自動化**
- 運用フローの属人化を解消し、**誰でも扱える共通の業務基盤**に

---

## スプレッドシート構成

| タブ名 | 概要 |
|--------|------|
| `00_INDEX` | 商材別レポートや月別集計へのリンクをまとめたインデックスシート |
| `01_DATA_FILTERED` | BigQueryから取得した全データの集約シートから、特定の商材データを自動抽出・集計（`IMPORTRANGE`・`QUERY`使用） |
| `02_MONTHLY_SUMMARY` | 各商材レポートシートから成果指標（CPA・CVRなど）を月別に集計。全体進捗を俯瞰できるダッシュボード的役割 |
| `2024-01_A_Report` | 商材Aの広告レポート（日次・週次の成果指標）※広告キャンペーン別の集計 |
| `2024-01_B_Report` | 商材Bの広告レポート（日次・週次の成果指標）※配信記事別の集計 |

※ 商材レポートタブは `YYYY-MM_商材名_Report` 形式で命名し、運用性と視認性を向上

---

## 使用技術
- Google スプレッドシート（QUERY, XLOOKUP, ARRAYFORMULA 等）
- Google Apps Script（GAS）
  - ChatGPTでのコード補助あり
- BigQuery（スプレッドシートのデータコネクタ経由）

---

## 利用対象者
- 広告運用チーム（ディレクター、クリエイター、マネージャー等）
- 社内の関連部署（営業、経営層）

---

## 活用による効果
- 毎月発生する更新作業を**ほぼ完全に自動化**し、**作業工数を月10時間以上削減**
- 作業プロセスをドキュメント化＋スクリプト化したことで**属人化を解消**
- ミスやヌケモレを防ぎつつ、誰でも同じ成果物を再現可能な環境を実現

---

## ファイル構成（GASスクリプト）

| ファイル名 | 役割 |
|------------|------|
| `onOpen.gs` | カスタムメニューの追加 |
| `trigger.gs` | 月末の定期自動実行を設定 |
| `multiprocessor.gs` | 複数処理をまとめて実行 |
| `copyTabs.gs` | 各商材レポートシートの複製処理 |
| `clearCells.gs` | 複製後に手入力エリアをクリア |
| `copyFunctionCells.gs` | 月別集計タブの関数セルを更新 |
| `getSheetName.gs` | INDEXタブに表示するシート名を取得 |
| `MoveActiveSheet.gs` | シートの並び順を調整 |
| `setFileNameToCell.gs` | スプレッドシートのファイル名をセルに表示 |

---

## 実際のスプレッドシート  
こちらから閲覧いただけます → [広告レポート自動集計スプレッドシート（閲覧用）](https://docs.google.com/spreadsheets/d/1d1GF3-Cb-T35ocooElEliWLSJrUc1L1500kz25qQSRg/edit?gid=644686713#gid=644686713)

