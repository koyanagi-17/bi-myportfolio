# SmartNews広告 入稿CSV自動生成ツール（GAS + スプレッドシート）

## 目的・背景
一度に大量のクリエイティブをSmartNews広告へ入稿するには、**配信クリエイティブごとに専用のCSVファイルを作成し、バナー画像とともにzipファイル化して提出**する必要がありました。
その作業には以下のような課題がありました：
- 作業時間が非常にかかる（組み合わせが多い場合、数時間〜半日以上）
- 作成したバナー画像は各個人のPCに保管されており、管理が煩雑
- ミスを防ぐためのチェックも手作業になりやすく、非効率

このツールは、**入稿作業の自動化・効率化・ミス防止**を目的として、Google スプレッドシートとGoogle Apps Script（GAS）を用いて開発されました。

---

## 概要
このツールは、SmartNews広告の一括入稿に必要なCSVファイルと、バナー画像を含んだzipファイルを、スプレッドシートの操作だけで自動生成できる仕組みです。
入力するデータ：
- 広告主名
- 広告グループID
- バナー画像のファイル名（Googleドライブ上に格納）
- 記事LPのURL
- 広告文（タイトル・説明文など）

スプレッドシート関数が自動で広告パターンを展開し整形、Google Apps Scriptが**媒体指定のCSV形式に出力**します。
また、指定されたバナーファイルを**Googleドライブから取得し、zipファイルとして保存・ダウンロード**できるようにしています。

---

## 特徴
- **Googleドライブの画像フォルダにアップロードするだけ**で、バナー画像・動画ファイルの情報（ファイル名、IDなど）を一覧化
- スプレッドシートで入力した情報をもとに、**広告パターンを関数で自動展開**
- **CSVファイルの生成とバナー画像のzip化をGASでワンクリック自動実行**
- バナー＋テキストの組み合わせ数が多い案件でも、**作業時間を大幅に短縮**
- スプレッドシートのみで完結するため、導入コスト・学習コストが低い

---

## スプレッドシート構成

| シート名 | 概要 |
|--------|------|
| `01_BANNER_FOLDER_LIST` | バナー画像・動画が格納されているGoogleドライブのフォルダ一覧。このリストをもとに各バナーの情報（ファイル名、ID）を自動で取得します。 |
| `02_BANNER_LIST` | バナー画像・動画の一覧。01_BANNER_FOLDER_LISTの一覧フォルダからファイル情報を自動取得・反映します。 |
| `03_LP_LIST` | 記事LPのURLリストを管理します。広告文とバナーを組み合わせる際に使用されます。 |
| `04_SN_BANNER` | 関数を用いて、02_BANNER_LISTからSmartNews広告用のバナーのみを抽出します。 |
| `05_SN_TEXT` | 広告文（タイトル・説明文など）のデータを作成します。 |
| `06_SN_INPUT` | 04_SN_BANNERと05_SN_TEXTをもとに、入稿したい広告パターンを作成。スクリプトを割り当てたボタンをクリックすることで、GASでCSVファイルとして出力される最終データと、バナー画像を含むzipファイルが保存されます。 |
| `07_SN_OUTPUT` | CSV化の直前データ。ここの内容がGASでCSVファイルとして出力されます。 |

---

## 使用技術
- Google スプレッドシート
   - 入稿データの作成、広告パターンの展開に活用。誰でも使えるUIでメンテナンスしやすく。
- Google Apps Script（GAS）
  - CSV生成、バナー画像の取得、zipファイルの作成・保存処理を自動化。ChatGPTを活用して一部コーディング支援。
- BigQuery（スプレッドシートのデータコネクタ経由）

---

## 利用対象者
- SmartNews広告の入稿作業を担当する広告運用者
- 配信ボリュームが多く、手動でのCSV作成・zip作成に時間を取られている方
- 入稿作業の効率化・属人化の解消を目指している広告代理店やインハウスのマーケ担当者

---

## 活用による効果
- **作業時間を大幅に短縮**：バナー × テキストの広告パターン展開～CSV出力・zip化までを自動化
- **作業ミスの防止**：媒体形式に準拠した出力仕様でヒューマンエラーを軽減
- **属人化の防止**：シートベースの簡単な運用により、他のメンバーでもすぐに引継ぎ可能

---

## ファイル構成（GASスクリプト）

| ファイル名 | 役割 |
|------------|------|
| `onOpen.gs` | カスタムメニューの追加 |
| `GetFileList.gs` | 指定フォルダ内のサブフォルダ一覧を取得 |
| `GetBannerList.gs` | バナーフォルダ内の画像・動画ファイルの情報を取得してスプレッドシートに出力 |
| `exportCsvAndJpg.gs` | 入稿データをCSV化し、バナーをzip化。ダウンロードURLを生成 |
| `deleteZipFile.gs` | 古いzipファイルを削除 |

--

## データフロー図（テキスト版）
[Googleドライブ画像フォルダ]
        ↓
[01_BANNER_FOLDER_LIST]
        ↓ GASでファイル取得
[02_BANNER_LIST]
        ↓ 関数で抽出
[04_SN_BANNER]
        ↓
[03_LP_LIST] ＋ [05_SN_TEXT]
（記事LP・広告文を入力）
        ↓ 関数で組み合わせ
[06_SN_INPUT]
（入稿パターンを作成）
        ↓ 関数で処理
[07_SN_OUTPUT]
        ↓ GASで処理
[CSV出力 + 画像zip化]

---

## 実績・補足情報

本ツールは、**広告運用業務の効率化を目的とした業務委託案件として受注・開発・納品**しました。
実際の広告入稿業務に導入され、**複数パターンの広告素材を数分で一括出力できるようになり、作業時間を大幅に短縮。**
担当者からも「作業効率が劇的に上がった」と高い評価をいただき、継続的な改善・拡張の相談もいただいています。

----

## 実際のスプレッドシート  
こちらから閲覧いただけます → [SmartNews広告 入稿CSV自動生成ツール（閲覧用）](https://docs.google.com/spreadsheets/d/1IgRgQu9y_3dHcsPGsxs1hUvc8_We5CCQus3Ji-sSiPk/edit?gid=968352328#gid=968352328)

