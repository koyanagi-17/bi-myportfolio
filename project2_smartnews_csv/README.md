# SmartNews広告入稿CSV自動生成ツール（Google Apps Script + Google スプレッドシート）

## 概要
SmartNews広告用の入稿データを**手動で作成していた手間を大幅に削減するツール**です。Google Apps Scriptを活用し、CSVファイルの自動生成を実現することで、データ入力ミスの削減と作業時間の短縮を達成します。

---

## 目的・背景
一度に大量のクリエイティブをSmartNews広告へ入稿するには、**配信クリエイティブごとに専用のCSVファイルを作成し、バナー画像とともにzipファイル化して提出**する必要がありました。  
その作業には以下のような課題がありました：
- 作業時間が非常にかかる（組み合わせが多い場合、数時間〜半日以上）
- 作成したバナー画像は各個人のPCに保管されており、管理が煩雑
- ミスを防ぐためのチェックも手作業になりやすく、非効率

このツールは、**入稿作業の自動化・効率化・ミス防止**を目的として、Google スプレッドシートとGASを用いて開発されました。

---

## 特徴
- **Googleドライブの画像フォルダにアップロードするだけ**で、バナー画像・動画ファイルの情報（ファイル名、IDなど）を一覧化
- Google スプレッドシートで入力した情報をもとに、**広告パターンを関数で自動展開**
- **CSVファイルの生成とバナー画像のzipファイル化をGASでワンクリック自動実行**
- バナー＋テキストの組み合わせ数が多い案件でも、**作業時間を大幅に短縮**
- **スプレッドシートのみで完結**するため、導入コスト・学習コストが低い

---

## Google スプレッドシート構成

| シート名 | 内容 |
|--------|------|
| `01_BANNER_FOLDER_LIST` | バナー画像・動画が格納されているGoogleドライブのフォルダ一覧。このリストをもとに各バナーの情報（ファイル名、ID）を自動で取得します。 |
| `02_BANNER_LIST` | バナー画像・動画の一覧。01_BANNER_FOLDER_LISTの一覧フォルダからファイル情報を自動取得・反映します。 |
| `03_LP_LIST` | 記事LPのURLリストを管理します。広告文とバナーを組み合わせる際に使用されます。 |
| `04_SN_BANNER` | 関数を用いて、02_BANNER_LISTからSmartNews広告用のバナーのみを抽出します。 |
| `05_SN_TEXT` | 広告文（タイトル・説明文など）のデータを作成します。 |
| `06_SN_INPUT` | 04_SN_BANNERと05_SN_TEXTをもとに、入稿したい広告パターンを作成。スクリプトを割り当てたボタンをクリックすることで、GASでCSVファイルとして出力される最終データと、バナー画像を含むzipファイルが保存されます。 |
| `07_SN_OUTPUT` | CSVファイル化の直前データ。ここの内容がGASでCSVファイルとして出力されます。 |

---

## 使用技術
- **Google スプレッドシート**
   - 入稿データの作成、広告パターンの展開に活用。誰でも使えるUIでメンテナンスしやすく。
- **Google Apps Script**
  - CSVファイル生成、バナー画像の取得、zipファイルの作成・保存処理を自動化。ChatGPTを活用して一部コーディング支援。

---

## 利用対象者
- SmartNews広告の運用担当者
- 複数パターンの広告入稿作業を効率化したいマーケター・ディレクター
- 入稿作業を外部パートナーや他部署に引き継ぎたい方

---

## 活用による効果
- Google スプレッドシートで簡単に広告パターンを生成 → **手作業の繰り返しがゼロに**
- ZIP化も自動 → **納品ファイルの作成時間を大幅短縮**
- 画像管理をクラウド化 → **PC内に画像が散在しない**

---

## ファイル構成（GAS）

| ファイル名 | 内容 |
|------------|------|
| `onOpen.gs` | カスタムメニューの追加 |
| `GetFileList.gs` | 指定したフォルダに格納されているフォルダのリストを作成 |
| `GetBannerList.gs` | 01_BANNER_FOLDER_LISTの一覧からバナー情報（ファイル名、URL、画像表示など）を取得・貼り付け |
| `exportCsvAndJpg.gs` | 07_SN_OUTPUTの内容をCSVファイルとして出力、バナーファイルをzip化しダウンロードリンクを生成 |
| `deleteZipFile.gs` | フォルダ内に保管されているzipファイルを削除 |

---

## データ処理の流れ

1. Googleドライブにある広告画像フォルダのパスをGoogle スプレッドシート `01_BANNER_FOLDER_LIST` に入力
2. GAS（`GetFileList.gs`）を実行し、各フォルダ内のファイル情報を `02_BANNER_LIST` に取得・出力
3. スプレッドシート関数でSmartNews広告用バナーのみを抽出し、`04_SN_BANNER` に表示
4. `03_LP_LIST`（LPリスト）および `05_SN_TEXT`（広告文リスト）と突き合わせて、`06_SN_INPUT` で各種広告パターンを生成
5. 関数で整形された出稿データを `07_SN_OUTPUT` に出力
6. GAS（`exportCsvAndJpg.gs`）でCSVファイルを出力し、画像はZIP形式でまとめてダウンロード可能にする

---

## 実際のGoogle スプレッドシート  
こちらから閲覧いただけます ↓
- [SmartNews広告入稿CSV自動生成ツール（閲覧用）](https://docs.google.com/spreadsheets/d/1IgRgQu9y_3dHcsPGsxs1hUvc8_We5CCQus3Ji-sSiPk/edit?gid=968352328#gid=968352328)

---

## 実績・補足情報

本ツールは、**広告運用業務の効率化を目的とした業務委託案件として受注・開発・納品**しました。
実際の広告入稿業務に導入され、**複数パターンの広告素材を数分で一括出力できるようになり、作業時間を大幅に短縮。**
担当者からも「作業効率が劇的に上がった」と高い評価をいただき、継続的な改善・拡張の相談もいただいています。

----

## 注意事項
本ツールは、実際の業務委託案件として開発・納品したものをベースに、一部編集・再構成したポートフォリオ用資料です。  
コードや構成を参考にしていただくことは問題ありませんが、実務用途でのご利用や再配布などはご遠慮ください。  
また、本ツールの利用により生じた問題について、作者は一切の責任を負いかねます。ご了承ください。

